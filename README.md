# クイックアクセスブックマーク

キーボードショートカットとオーバーレイインターフェースで、ブックマークと最近の履歴に素早くアクセスできるChrome拡張機能です。

## 機能

-   **クイックアクセスオーバーレイ**: `Ctrl+Shift+B` (Macでは `Command+Shift+B`) でオーバーレイを表示/非表示できます。
-   **ブックマークと履歴**:
    -   ブックマークバーの最初の9個のアイテムを表示します。
    -   閲覧履歴の最新9個のアイテムを表示します。
    -   `Tab` キーで「ブックマーク」と「最近の履歴」を切り替えできます。
-   **キーボードナビゲーション**:
    -   `1` から `9` のキーを押すと、対応するリンクを開きます。
    -   `Esc` でオーバーレイを閉じます。
-   **マウス操作**:
    -   任意のアイテムをクリックして開くことができます。
    -   オーバーレイの外側をクリックすると閉じます。
-   **レスポンシブデザイン**:
    -   オーバーレイはビューポートの95%の幅と高さに最大化されます。
    -   長いURLは自動的に省略されます。
    -   コンテンツが画面の高さを超える場合はスクロール可能です。

## インストール

1.  このリポジトリをクローンするか、ソースコードをダウンロードします。
2.  Chromeを開き、`chrome://extensions/` に移動します。
3.  右上の「デベロッパーモード」を有効にします。
4.  「パッケージ化されていない拡張機能を読み込む」をクリックし、拡張機能ファイルが含まれるディレクトリを選択します。

## 使い方

1.  **オーバーレイの表示/非表示**:
    -   Windows/Linux: `Ctrl + Shift + B`
    -   Mac: `Command + Shift + B`
2.  **モードの切り替え**:
    -   オーバーレイが開いている状態で `Tab` を押すと、ブックマークと履歴を切り替えられます。
3.  **リンクを開く**:
    -   アイテムに対応する数字キー (`1`-`9`) を押します。
    -   またはマウスでアイテムをクリックします。
4.  **オーバーレイを閉じる**:
    -   `Esc` を押します。
    -   再び `Ctrl + Shift + B` を押します。
    -   オーバーレイの外側をクリックします。

## アクセス許可

-   `bookmarks`: ブックマークにアクセスするため。
-   `history`: 最近の閲覧履歴にアクセスするため。
-   `activeTab`: 現在のページにオーバーレイを表示するため。
-   `favicon`: ウェブサイトのファビコンを取得するため。

## Technical Specifications

### Shadow DOM Implementation

この拡張機能は **Shadow DOM** を使用してオーバーレイUIを描画しています。これにより、以下のメリットがあります:

#### メリット

1. **スタイルの完全な隔離**
   - ページ上の既存のCSSがオーバーレイのデザインに影響しません
   - 逆に、オーバーレイのスタイルがページのコンテンツに影響することもありません

2. **一貫性のあるUI**
   - どのウェブサイトで開いても、常に同じ見た目と動作が保証されます
   - ページの `!important` スタイルや特異性の高いCSSセレクターの影響を受けません

3. **カプセル化**
   - オーバーレイのDOM構造とスタイルが完全にカプセル化されています
   - ページのJavaScriptからオーバーレイの内部構造に干渉されることを防ぎます

#### 実装の詳細

- **コンテナ要素**: `quick-access-bookmark-overlay-container` というIDを持つコンテナをページのDOMに追加
- **Shadow Root**: コンテナに `attachShadow({ mode: 'open' })` でShadow Rootをアタッチ
- **スタイルの配置**: すべてのCSSスタイルは `<style>` タグとしてShadow DOM内に配置
- **イベントハンドリング**: クリックイベントは `composedPath()` を使用してShadow DOM境界を越えて正しく検出

#### コード構造

```javascript
// Shadow Rootをアタッチ
shadowRoot = container.attachShadow({ mode: 'open' });

// Shadow DOM内にスタイルを追加
const styleElement = document.createElement('style');
styleElement.textContent = overlayStyles;
shadowRoot.appendChild(styleElement);

// オーバーレイコンテンツを追加
const wrapper = document.createElement('div');
wrapper.className = 'overlay-wrapper';
shadowRoot.appendChild(wrapper);
```

この実装により、ページのCSS環境に依存せず、常に安定したユーザー体験を提供できます。
